<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>–ú–æ–π –ú–∞–≥–∞–∑–∏–Ω</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; }
        .price-low { color: green; font-weight: bold; }
    </style>
</head>
<body>

<h1>–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</h1>
<div sec:authorize="hasRole('ADMIN')">
    <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h2>
    <form method="post" th:action="@{/store}">
        <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
        <input type="number" name="price" placeholder="–¶–µ–Ω–∞" required>
        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
    </form>
    <hr>
</div>

<table>
    <thead>
    <tr>
        <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
        <th>ID</th>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–¶–µ–Ω–∞</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="p : ${products}">
        <td>
            <form th:action="@{/store/delete/{id}(id=${p.id})}" method="post" sec:authorize="hasRole('ADMIN')">
                <button type="submit" style="color: red;">–£–¥–∞–ª–∏—Ç—å üóë</button>
            </form>
        </td>
        <td th:text="${p.id}">1</td>
        <td th:text="${p.name}">iPhone</td>
        <td th:text="${p.price}" th:class="${p.price < 5000} ? 'price-low' : ''">9999</td>
    </tr>
    </tbody>
</table>
<hr>
<div sec:authorize="isAuthenticated()">
    <p>
        –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <b sec:authentication="name"></b>
        <span sec:authorize="hasRole('ADMIN')">(–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</span>
    </p>

    <form th:action="@{/logout}" method="post">
        <button type="submit">–í—ã–π—Ç–∏</button>
    </form>
</div>

<div sec:authorize="!isAuthenticated()">
    <a href="/login">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>
</div>
</body>
</html>